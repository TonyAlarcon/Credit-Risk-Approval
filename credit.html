<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Credit Risk Approval</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Website title</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="credit.html">Credit Risk Approval</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Credit Risk Approval</h1>

</div>


<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(plotly)
<span class="kw">library</span>(tidyr)
<span class="kw">library</span>(reshape2)
<span class="kw">library</span>(cowplot)
<span class="kw">library</span>(ggExtra)
<span class="kw">library</span>(ggcorrplot)
<span class="kw">library</span>(DataExplorer)
<span class="kw">library</span>(tidyr) <span class="co">#to seperate data into several columns</span>
<span class="kw">library</span>(scales) <span class="co">#for percentages</span>
<span class="kw">library</span>(gtable)
<span class="kw">library</span>(gridExtra)
<span class="kw">library</span>(grid)
<span class="kw">library</span>(MASS) <span class="co">#for LDA model fitting</span>
<span class="kw">library</span>(rockchalk) <span class="co">#combine factor levels</span>
<span class="kw">library</span>(knitr)
<span class="kw">library</span>(kableExtra)
<span class="kw">library</span>(randomForest)
<span class="kw">library</span>(e1071)</code></pre></div>
<div id="introduction-executive-summary" class="section level1">
<h1>Introduction &amp; Executive Summary</h1>
<p>This data set was donated by Prof. Hofmann and is available at the <a href="https://archive.ics.uci.edu/ml/datasets/statlog+(german+credit+data)">UCI Machine Learning Respitory</a>.</p>
<blockquote>
<p>Given various categorical and numerical features, the aim is to build a predictive model that determines whether a bank loan applicant is a good or bad credit risk in order to assist banks in decision making when confronted with a loan applicant. These decisions are translated as profit consideration for the banks The associated risks are as follows:</p>
</blockquote>
<ul>
<li>If an applicant is credit worthy, then denying a loan application results in a loss in business profit.</li>
<li>If an applicant is not credit worthy, then approving the loan application results in financial loss.</li>
</ul>
<p>We assume a correct bank decision leads to 35% profit. Otherwise, if bank decises an applicant is credit worthy when in reality they are not, then the loss is 100%. Hence, the second risk has more weight than the first.</p>
<p>Source: Dua, D. and Karra Taniskidou, E. (2017). UCI Machine Learning Repository [<a href="http://archive.ics.uci.edu/ml" class="uri">http://archive.ics.uci.edu/ml</a>]. Irvine, CA: University of California, School of Information and Computer Science.</p>
</div>
<div id="user-defined-function" class="section level1">
<h1>User-Defined Function</h1>
<p><em>cost_profit_cal</em> This function calculates the profit per applicant based on the formula [True Positive]x.35 + [False Positive] x-1 The argument takes a two element vector first first elemenet one = True Positive and element two = False Positive</p>
<p><em>create.plots</em> Function takes in a data frame and a plotting function as their arguments and uses lapply() to create a list of plots from a specifiec data frame. In addition, a for loop is used to paste the corresponding variable name from the data to the elements of plot list. The need for this function was neccessary in order to easily plot frequency distributions, histograms, dodged bars, etc of all variables at once and in a single page. This saves time meanwhile allowing me to analyze many variables at once with ease.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cost_profit_cal =<span class="st"> </span><span class="cf">function</span>(x){
  profit =<span class="st"> </span>(x[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>.<span class="dv">35</span>) <span class="op">+</span><span class="st"> </span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span>x[<span class="dv">2</span>]) <span class="co">#calculates profit</span>
  row =<span class="st"> </span><span class="kw">c</span>(x,profit) <span class="co">#appends to TN and FN vector</span>
  <span class="kw">return</span>(row)
}



<span class="co">#function takes a data frame and a plot function as its arguments and </span>
<span class="co">#returns a list of ggplots with their corresponding variable name pasted. </span>
create.plots =<span class="st"> </span><span class="cf">function</span>(data.frame, plot.function){
  
plot.list =<span class="st"> </span><span class="kw">lapply</span>(data.frame, <span class="cf">function</span>(i) <span class="kw">plot.function</span>(i) ) <span class="co">#creates a list of plots</span>

plots =<span class="st"> </span><span class="kw">list</span>() <span class="co">#empty list to save updated plots</span>
j=<span class="dv">0</span>
<span class="cf">for</span>( i <span class="cf">in</span> plot.list){
  j=j<span class="op">+</span><span class="dv">1</span>
  i =<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">names</span>(plot.list)[j]) <span class="co">#paste corresponding names to each plot</span>
  plots[[j]] =<span class="st"> </span>i <span class="co">#adds plot to list</span>
}
<span class="kw">return</span>(plots)
}</code></pre></div>
</div>
<div id="importing-preparing-data-set" class="section level1">
<h1>Importing &amp; Preparing Data Set</h1>
<p>To begin with, I’ll import the data file from UCI Machine Learning Respitory. From prior inspection, we note that the data is in .data file type with columns seperated by spaces. I will also change column names to get a better representation of the columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">url =<span class="st"> &quot;https://archive.ics.uci.edu/ml/machine-learning-databases/statlog/german/german.data&quot;</span>
df =<span class="st"> </span><span class="kw">read.table</span>(url, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>) <span class="co">#reads .data files</span>


attr_info =<span class="st"> </span>
<span class="st">&quot;Attribute 1: (qualitative) </span>
<span class="st">StatusCheckingAcc</span>
<span class="st">A11 : ... &lt; 0 DM </span>
<span class="st">A12 : 0 &lt;= ... &lt; 200 DM </span>
<span class="st">A13 : ... &gt;= 200 DM </span>
<span class="st">A14 : no checking account </span>

<span class="st">Attribute 2: (numerical) </span>
<span class="st">Duration</span>

<span class="st">Attribute 3: (qualitative) </span>
<span class="st">CreditHistory</span>
<span class="st">A30 : all credits paid back duly </span>
<span class="st">A31 : all credits at this bank paid back duly </span>
<span class="st">A32 : existing credits paid back duly till now </span>
<span class="st">A33 : delay in paying off in the past </span>
<span class="st">A34 : credits existing (not at this bank) </span>

<span class="st">Attribute 4: (qualitative) </span>
<span class="st">Purpose</span>
<span class="st">A40 : car (new) </span>
<span class="st">A41 : car (used) </span>
<span class="st">A42 : furniture/equipment </span>
<span class="st">A43 : radio/television </span>
<span class="st">A44 : domestic appliances </span>
<span class="st">A45 : repairs </span>
<span class="st">A46 : education </span>
<span class="st">A47 : vacation </span>
<span class="st">A48 : retraining </span>
<span class="st">A49 : business </span>
<span class="st">A410 : others </span>

<span class="st">Attribute 5: (numerical) </span>
<span class="st">CreditAmount</span>

<span class="st">Attribute 6: (qualitative) </span>
<span class="st">SavingsAccount</span>
<span class="st">A61 : ... &lt; 100 DM </span>
<span class="st">A62 : 100 &lt;= ... &lt; 500 DM </span>
<span class="st">A63 : 500 &lt;= ... &lt; 1000 DM </span>
<span class="st">A64 : .. &gt;= 1000 DM </span>
<span class="st">A65 : no savings</span>

<span class="st">Attribute 7: (qualitative) </span>
<span class="st">EmployedSince</span>
<span class="st">A71 : unemployed </span>
<span class="st">A72 : ... &lt; 1 year </span>
<span class="st">A73 : 1 &lt;= ... &lt; 4 years </span>
<span class="st">A74 : 4 &lt;= ... &lt; 7 years </span>
<span class="st">A75 : .. &gt;= 7 years </span>

<span class="st">Attribute 8: (numerical) </span>
<span class="st">InstallmentRate</span>

<span class="st">Attribute 9: (qualitative) </span>
<span class="st">SexPersonalStatus</span>
<span class="st">A91 : male - divorced/separated </span>
<span class="st">A92 : female - divorced/separated/married </span>
<span class="st">A93 : male - single </span>
<span class="st">A94 : male - married/widowed </span>
<span class="st">A95 : female - single </span>

<span class="st">Attribute 10: (qualitative) </span>
<span class="st">OtherDebtors</span>
<span class="st">A101 : none </span>
<span class="st">A102 : co-applicant </span>
<span class="st">A103 : guarantor </span>

<span class="st">Attribute 11: (numerical) </span>
<span class="st">PresentResidenceSince</span>

<span class="st">Attribute 12: (qualitative) </span>
<span class="st">Property</span>
<span class="st">A121 : real estate </span>
<span class="st">A122 : building  </span>
<span class="st">A123 : car or other, not in attribute 6 </span>
<span class="st">A124 : no property </span>

<span class="st">Attribute 13: (numerical) </span>
<span class="st">Age</span>

<span class="st">Attribute 14: (qualitative) </span>
<span class="st">OtherInstallments</span>
<span class="st">A141 : bank </span>
<span class="st">A142 : stores </span>
<span class="st">A143 : none </span>

<span class="st">Attribute 15: (qualitative) </span>
<span class="st">Housing</span>
<span class="st">A151 : rent </span>
<span class="st">A152 : own </span>
<span class="st">A153 : for free </span>

<span class="st">Attribute 16: (numerical) </span>
<span class="st">NumberOfExistingCredits</span>

<span class="st">Attribute 17: (qualitative) </span>
<span class="st">Job</span>
<span class="st">A171 : unemployed/ unskilled </span>
<span class="st">A172 : unskilled - resident </span>
<span class="st">A173 : skilled employee / official </span>
<span class="st">A174 : management/ self-employed/ </span>
<span class="st">highly qualified employee/ officer </span>

<span class="st">Attribute 18: (numerical) </span>
<span class="st">NumberOfPeopleLiable</span>

<span class="st">Attribute 19: (qualitative) </span>
<span class="st">Telephone</span>
<span class="st">A191 : none </span>
<span class="st">A192 : yes </span>

<span class="st">Attribute 20: (qualitative) </span>
<span class="st">ForeignWorker</span>
<span class="st">A201 : yes </span>
<span class="st">A202 : no </span>

<span class="st">Attribute 21: (quantitative)</span>
<span class="st">GoodCredit</span>
<span class="st">1: Good</span>
<span class="st">2: Bad</span>
<span class="st">&quot;</span>

attr_list =<span class="st"> </span><span class="kw">as.list</span>(<span class="kw">as.vector</span>(<span class="kw">strsplit</span>(attr_info, <span class="st">&quot;Attribute &quot;</span>)[[<span class="dv">1</span>]])[<span class="dv">2</span><span class="op">:</span><span class="dv">22</span>])

attr_names =<span class="st"> </span><span class="kw">sapply</span>(attr_list, <span class="cf">function</span>(attr_desc) <span class="kw">strsplit</span>(attr_desc, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])

<span class="kw">colnames</span>(df) =<span class="st"> </span>attr_names</code></pre></div>
</div>
<div id="data-exploration" class="section level1">
<h1>Data Exploration</h1>
<div id="variable-identification" class="section level2">
<h2>Variable Identification</h2>
<p>Let’s check the first 6 rows of our data, along with its dimensions and data type of our variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(df); <span class="kw">str</span>(df); <span class="kw">head</span>(df)</code></pre></div>
<pre><code>## [1] 1000   21</code></pre>
<pre><code>## &#39;data.frame&#39;:    1000 obs. of  21 variables:
##  $ StatusCheckingAcc      : Factor w/ 4 levels &quot;A11&quot;,&quot;A12&quot;,&quot;A13&quot;,..: 1 2 4 1 1 4 4 2 4 2 ...
##  $ Duration               : int  6 48 12 42 24 36 24 36 12 30 ...
##  $ CreditHistory          : Factor w/ 5 levels &quot;A30&quot;,&quot;A31&quot;,&quot;A32&quot;,..: 5 3 5 3 4 3 3 3 3 5 ...
##  $ Purpose                : Factor w/ 10 levels &quot;A40&quot;,&quot;A41&quot;,&quot;A410&quot;,..: 5 5 8 4 1 8 4 2 5 1 ...
##  $ CreditAmount           : int  1169 5951 2096 7882 4870 9055 2835 6948 3059 5234 ...
##  $ SavingsAccount         : Factor w/ 5 levels &quot;A61&quot;,&quot;A62&quot;,&quot;A63&quot;,..: 5 1 1 1 1 5 3 1 4 1 ...
##  $ EmployedSince          : Factor w/ 5 levels &quot;A71&quot;,&quot;A72&quot;,&quot;A73&quot;,..: 5 3 4 4 3 3 5 3 4 1 ...
##  $ InstallmentRate        : int  4 2 2 2 3 2 3 2 2 4 ...
##  $ SexPersonalStatus      : Factor w/ 4 levels &quot;A91&quot;,&quot;A92&quot;,&quot;A93&quot;,..: 3 2 3 3 3 3 3 3 1 4 ...
##  $ OtherDebtors           : Factor w/ 3 levels &quot;A101&quot;,&quot;A102&quot;,..: 1 1 1 3 1 1 1 1 1 1 ...
##  $ PresentResidenceSince  : int  4 2 3 4 4 4 4 2 4 2 ...
##  $ Property               : Factor w/ 4 levels &quot;A121&quot;,&quot;A122&quot;,..: 1 1 1 2 4 4 2 3 1 3 ...
##  $ Age                    : int  67 22 49 45 53 35 53 35 61 28 ...
##  $ OtherInstallments      : Factor w/ 3 levels &quot;A141&quot;,&quot;A142&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ Housing                : Factor w/ 3 levels &quot;A151&quot;,&quot;A152&quot;,..: 2 2 2 3 3 3 2 1 2 2 ...
##  $ NumberOfExistingCredits: int  2 1 1 1 2 1 1 1 1 2 ...
##  $ Job                    : Factor w/ 4 levels &quot;A171&quot;,&quot;A172&quot;,..: 3 3 2 3 3 2 3 4 2 4 ...
##  $ NumberOfPeopleLiable   : int  1 1 2 2 2 2 1 1 1 1 ...
##  $ Telephone              : Factor w/ 2 levels &quot;A191&quot;,&quot;A192&quot;: 2 1 1 1 1 2 1 2 1 1 ...
##  $ ForeignWorker          : Factor w/ 2 levels &quot;A201&quot;,&quot;A202&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ GoodCredit             : int  1 2 1 1 2 1 1 1 1 2 ...</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["StatusCheckingAcc"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["Duration"],"name":[2],"type":["int"],"align":["right"]},{"label":["CreditHistory"],"name":[3],"type":["fctr"],"align":["left"]},{"label":["Purpose"],"name":[4],"type":["fctr"],"align":["left"]},{"label":["CreditAmount"],"name":[5],"type":["int"],"align":["right"]},{"label":["SavingsAccount"],"name":[6],"type":["fctr"],"align":["left"]},{"label":["EmployedSince"],"name":[7],"type":["fctr"],"align":["left"]},{"label":["InstallmentRate"],"name":[8],"type":["int"],"align":["right"]},{"label":["SexPersonalStatus"],"name":[9],"type":["fctr"],"align":["left"]},{"label":["OtherDebtors"],"name":[10],"type":["fctr"],"align":["left"]},{"label":["PresentResidenceSince"],"name":[11],"type":["int"],"align":["right"]},{"label":["Property"],"name":[12],"type":["fctr"],"align":["left"]},{"label":["Age"],"name":[13],"type":["int"],"align":["right"]},{"label":["OtherInstallments"],"name":[14],"type":["fctr"],"align":["left"]},{"label":["Housing"],"name":[15],"type":["fctr"],"align":["left"]},{"label":["NumberOfExistingCredits"],"name":[16],"type":["int"],"align":["right"]},{"label":["Job"],"name":[17],"type":["fctr"],"align":["left"]},{"label":["NumberOfPeopleLiable"],"name":[18],"type":["int"],"align":["right"]},{"label":["Telephone"],"name":[19],"type":["fctr"],"align":["left"]},{"label":["ForeignWorker"],"name":[20],"type":["fctr"],"align":["left"]},{"label":["GoodCredit"],"name":[21],"type":["int"],"align":["right"]}],"data":[{"1":"A11","2":"6","3":"A34","4":"A43","5":"1169","6":"A65","7":"A75","8":"4","9":"A93","10":"A101","11":"4","12":"A121","13":"67","14":"A143","15":"A152","16":"2","17":"A173","18":"1","19":"A192","20":"A201","21":"1","_rn_":"1"},{"1":"A12","2":"48","3":"A32","4":"A43","5":"5951","6":"A61","7":"A73","8":"2","9":"A92","10":"A101","11":"2","12":"A121","13":"22","14":"A143","15":"A152","16":"1","17":"A173","18":"1","19":"A191","20":"A201","21":"2","_rn_":"2"},{"1":"A14","2":"12","3":"A34","4":"A46","5":"2096","6":"A61","7":"A74","8":"2","9":"A93","10":"A101","11":"3","12":"A121","13":"49","14":"A143","15":"A152","16":"1","17":"A172","18":"2","19":"A191","20":"A201","21":"1","_rn_":"3"},{"1":"A11","2":"42","3":"A32","4":"A42","5":"7882","6":"A61","7":"A74","8":"2","9":"A93","10":"A103","11":"4","12":"A122","13":"45","14":"A143","15":"A153","16":"1","17":"A173","18":"2","19":"A191","20":"A201","21":"1","_rn_":"4"},{"1":"A11","2":"24","3":"A33","4":"A40","5":"4870","6":"A61","7":"A73","8":"3","9":"A93","10":"A101","11":"4","12":"A124","13":"53","14":"A143","15":"A153","16":"2","17":"A173","18":"2","19":"A191","20":"A201","21":"2","_rn_":"5"},{"1":"A14","2":"36","3":"A32","4":"A46","5":"9055","6":"A65","7":"A73","8":"2","9":"A93","10":"A101","11":"4","12":"A124","13":"35","14":"A143","15":"A153","16":"1","17":"A172","18":"2","19":"A192","20":"A201","21":"1","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>This data set consists of 1000 rows and 21 columns. The first 20 are the predictors and the the last is the target variable which is a numerical data type. Being a binary classification problem, I will turn this variable into a factor.</p>
<p>Furthermore, note that most of the columns are categorical predictors (13 of them) with several levels. In addition, these levels have been encoded into symbolic characters. Personally, before analysing data with various visual techniques, I prefer to have the factor levels with descriptive names for better interpretability. Hence, I will change the factor names as described in the German data set description, before proceeding any further.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">21</span>){
  attr_desc =<span class="st"> </span>attr_list[[i]]
  <span class="cf">if</span>(<span class="kw">length</span>(<span class="kw">grep</span>(<span class="st">&quot;qualitative&quot;</span>,attr_desc))<span class="op">&gt;</span><span class="dv">0</span>){
    lines_all =<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">strsplit</span>(attr_desc, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)[[<span class="dv">1</span>]])
    lines =<span class="st"> </span>lines_all[<span class="dv">3</span><span class="op">:</span>(<span class="kw">length</span>(lines_all)<span class="op">-</span><span class="dv">1</span>)]
    str_vals =<span class="st"> </span><span class="kw">sapply</span>(lines, <span class="cf">function</span>(line) <span class="kw">strsplit</span>(line, <span class="st">&quot; : &quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])
    df[,i] =<span class="st"> </span><span class="kw">as.numeric</span>(df[,i])
    
    <span class="cf">for</span> (val_i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(lines)){
      df[,i] &lt;-<span class="st"> </span><span class="kw">ifelse</span>(df[,i]<span class="op">==</span>val_i, str_vals[val_i], df[,i])
    }
  }
}</code></pre></div>
<p>Next, I will subset each predictor based on variable category and check the proportions of the target variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">numerical =<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">11</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">18</span>)
factorials =<span class="st"> </span><span class="kw">setdiff</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">21</span>,numerical)
df.cat =<span class="st"> </span>df[,factorials]  <span class="co">#categorical subset</span>
df.num =<span class="st"> </span>df[,numerical] <span class="co">#numerical subset</span>


<span class="kw">prop.table</span>(<span class="kw">table</span>(df.cat<span class="op">$</span>GoodCredit)) <span class="co">#checking target level propotions</span></code></pre></div>
<pre><code>## 
##   1   2 
## 0.7 0.3</code></pre>
<p>It seems that the target variable is somewhat imbalanced, with the majority class (credible applicants) having a 70% proportion and the minority class with 30%. This will be important to keep in mind since missclassifying a non-credit worthy applicant has a bigger penalty than missclassifying a credit worthy applicant.</p>
</div>
<div id="univariate-analysis" class="section level2">
<h2>Univariate Analysis</h2>
<p>As previosly stated, the majority of the predictors are categorical variables with several levels. This may be a problem since a full cross-classification of all variables may lead to zero observations in many cells. Therefore, we need to eliminate the variables that have little influence. In addition, we can combine categorical levels on imbalanced predictors, where a level has a frequency less than 5%. To do this, lets get an idea of the distributions of factor levels in each categorical veriable. I will do this by plotting bar charts.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bar_chart =<span class="st"> </span><span class="cf">function</span>(i){
  <span class="kw">ggplot</span>(df.cat, <span class="kw">aes</span>(<span class="dt">x =</span> i)) <span class="op">+</span><span class="st"> </span>
<span class="st">          </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>,<span class="dt">stat =</span> <span class="st">&quot;count&quot;</span> ,<span class="kw">aes</span>(<span class="dt">y =</span> (..count..)<span class="op">/</span><span class="kw">sum</span>(..count..))) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels=</span>scales<span class="op">::</span>percent) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;rel frequencies&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">25</span>, <span class="dt">vjust=</span><span class="fl">0.6</span>)) 
}

bar.charts =<span class="st"> </span><span class="kw">create.plots</span>(df.cat, bar_chart)

<span class="kw">do.call</span>(grid.arrange,bar.charts[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] )</code></pre></div>
<p><img src="credit_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">do.call</span>(grid.arrange,bar.charts[<span class="dv">5</span><span class="op">:</span><span class="dv">8</span>])</code></pre></div>
<p><img src="credit_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">do.call</span>(grid.arrange,bar.charts[<span class="dv">8</span><span class="op">:</span><span class="dv">11</span>])</code></pre></div>
<p><img src="credit_files/figure-html/unnamed-chunk-7-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">do.call</span>(grid.arrange,bar.charts[<span class="dv">12</span><span class="op">:</span><span class="dv">14</span>])</code></pre></div>
<p><img src="credit_files/figure-html/unnamed-chunk-7-4.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#(lapply(df.cat, function(x) margin.table(prop.table(table(x)),1 ))) </span></code></pre></div>
<p>Analysis of imbalanced predictors from bar plot and proportion table results:</p>
<ol style="list-style-type: decimal">
<li><p>$AccountStatus: Only 6.3% of applicant have an account balance above 200 DM (about 120 US dollars ). We can merge this with applicants that have a balance of 0 to 200 DM and name the new level as “some balance”</p></li>
<li><p>$CreditHistory:</p></li>
<li><p>$Purpose: Most individuals tend to apply to credit for their car payments and furniture. We can generalize the furniture, radio/television, repairs, and domestic into a “home related” purpose. Education, vacation, and retraining make up less than 1% each, we can include it into an “others” level and include business along too.</p></li>
<li><p>$Account: It seems most people have less than 100 DM (about 60 dollars) in their savings account. We can group individuals with savings from 100 to above 1000.</p></li>
<li><p>$EmploymentSince: only 6.2% of individuals are unemployed, while other levels contain &gt; 17%. We can bin unemployment and below 1 year into a single level.</p></li>
<li><p>$PersonalStatus: divorced males make up 5% of applicants, we may bin this with the single males.</p></li>
<li><p>$OtherDebtors: guarantors and co applicant levels can be bined together to create a “yes” or “no” levels.</p></li>
<li><p>$OtherInstallPlans: We can merge bank and store credit installments to make a new level since stores only have a 4.7% frequency. Either you have concurrent credit or you dont.</p></li>
<li><p>$Job: unskilled and unemployed/nonresident can be generalized to simply unskilled. The new levels can then become unskilled/unemployed, skilled, and highly skilled/management.</p></li>
<li><p>$ForeignWorker: Only 3.7% of applicants are not foreign workers. Since there are only two levels, we can potentially eliminate this variable all together.</p></li>
</ol>
<p>Now for continuos variables, it is important to understand the spread and central tendency of the variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#function plots a histogram given a data frame column</span>
histogram =<span class="st"> </span><span class="cf">function</span>(i){
  <span class="kw">ggplot</span>(df.num, <span class="kw">aes</span>(<span class="dt">x =</span>i  )) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">color=</span> <span class="st">&quot;black&quot;</span>, <span class="dt">bins =</span> <span class="dv">10</span>) 
}


histo.plots =<span class="st"> </span><span class="kw">create.plots</span>(df.num, histogram)


<span class="kw">do.call</span>(grid.arrange,<span class="kw">lapply</span>(histo.plots[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="cf">function</span>(x) <span class="kw">ggMarginal</span>(x, <span class="dt">type =</span> <span class="st">&quot;boxplot&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;transparent&quot;</span>, <span class="dt">margins =</span> <span class="st">&quot;y&quot;</span>) ))</code></pre></div>
<p><img src="credit_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">do.call</span>(grid.arrange,<span class="kw">lapply</span>(histo.plots[<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>], <span class="cf">function</span>(x) <span class="kw">ggMarginal</span>(x, <span class="dt">type =</span> <span class="st">&quot;boxplot&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;transparent&quot;</span>, <span class="dt">margins =</span> <span class="st">&quot;y&quot;</span>) ))</code></pre></div>
<p><img src="credit_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
</div>
<div id="bi-variate-analysis" class="section level2">
<h2>Bi-variate Analysis</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(grid)
bar =<span class="st"> </span><span class="cf">function</span>(i){
   <span class="kw">ggplot</span>(df.cat, <span class="kw">aes</span>(<span class="dt">x=</span>i,<span class="dt">group =</span> GoodCredit ,<span class="dt">fill=</span><span class="kw">factor</span>(GoodCredit))) <span class="op">+</span>
<span class="st">   </span><span class="kw">geom_bar</span>(<span class="dt">position=</span><span class="st">&quot;dodge&quot;</span> ,<span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">stat =</span> <span class="st">&quot;count&quot;</span>, <span class="kw">aes</span>(<span class="dt">y =</span> ..prop..))<span class="op">+</span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">10</span>, <span class="dt">vjust=</span>.<span class="dv">6</span>)) <span class="op">+</span><span class="kw">geom_text</span>(<span class="kw">aes</span>( <span class="dt">label =</span> scales<span class="op">::</span><span class="kw">percent</span>(..prop..), <span class="dt">y=</span> ..prop.. ), <span class="dt">stat=</span> <span class="st">&quot;count&quot;</span>)<span class="op">+</span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Pastel1&quot;</span>)
}

dodged.bars =<span class="st"> </span><span class="kw">create.plots</span>(df.cat, bar)

<span class="kw">do.call</span>(grid.arrange,dodged.bars[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</code></pre></div>
<p><img src="credit_files/figure-html/unnamed-chunk-9-1.png" width="672" /> continuos variables</p>
</div>
</div>
<div id="data-engineering" class="section level1">
<h1>Data Engineering</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eng.df.cat =<span class="st"> </span>df.cat
eng.df.cat[] =<span class="st"> </span><span class="kw">lapply</span>(eng.df.cat, factor)

eng.df.cat<span class="op">$</span>StatusCheckingAcc =<span class="st"> </span><span class="kw">combineLevels</span>(eng.df.cat<span class="op">$</span>StatusCheckingAcc,<span class="dt">levs =</span> <span class="kw">c</span>(<span class="st">&quot;... &gt;= 200 DM &quot;</span>,<span class="st">&quot;0 &lt;= ... &lt; 200 DM &quot;</span>), <span class="dt">newLabel =</span> <span class="kw">c</span>(<span class="st">&quot;Some Balance&quot;</span>) )


eng.df.cat<span class="op">$</span>Purpose =<span class="st"> </span><span class="kw">combineLevels</span>(eng.df.cat<span class="op">$</span>Purpose, <span class="dt">levs=</span> <span class="kw">c</span>(<span class="st">&quot;domestic appliances &quot;</span>,  <span class="st">&quot;radio/television &quot;</span>,<span class="st">&quot;furniture/equipment &quot;</span>), <span class="dt">newLabel =</span> <span class="kw">c</span>(<span class="st">&quot;Home Related&quot;</span>))
eng.df.cat<span class="op">$</span>Purpose =<span class="st"> </span><span class="kw">combineLevels</span>(eng.df.cat<span class="op">$</span>Purpose, <span class="dt">levs=</span><span class="kw">c</span>(<span class="st">&quot;business &quot;</span> ,<span class="st">&quot;repairs &quot;</span>,<span class="st">&quot;education &quot;</span>,<span class="st">&quot;vacation &quot;</span>,<span class="st">&quot;retraining &quot;</span>), <span class="dt">newLabel =</span> <span class="kw">c</span>(<span class="st">&quot;Other&quot;</span>))

eng.df.cat<span class="op">$</span>SavingsAccount =<span class="st"> </span><span class="kw">combineLevels</span>(eng.df.cat<span class="op">$</span>SavingsAccount, <span class="dt">levs =</span> <span class="kw">c</span>(<span class="st">&quot;.. &gt;= 1000 DM &quot;</span>,<span class="st">&quot;500 &lt;= ... &lt; 1000 DM &quot;</span>), <span class="dt">newLabel =</span> <span class="kw">c</span>(<span class="st">&quot;&gt;= 500&quot;</span>))

eng.df.cat<span class="op">$</span>EmployedSince =<span class="st"> </span><span class="kw">combineLevels</span>(eng.df.cat<span class="op">$</span>EmployedSince, <span class="dt">levs =</span> <span class="kw">c</span>(<span class="st">&quot;... &lt; 1 year &quot;</span>, <span class="st">&quot;unemployed &quot;</span>), <span class="dt">newLabel =</span> <span class="kw">c</span>(<span class="st">&quot;&lt;1 or unemployed&quot;</span>))

eng.df.cat<span class="op">$</span>SexPersonalStatus =<span class="st"> </span><span class="kw">combineLevels</span>(eng.df.cat<span class="op">$</span>SexPersonalStatus, <span class="dt">levs =</span> <span class="kw">c</span>(<span class="st">&quot;male - divorced/separated &quot;</span>,<span class="st">&quot;male - single &quot;</span> ), <span class="dt">newLabel =</span> <span class="st">&quot;male - single/divorced&quot;</span> )

<span class="kw">levels</span>(eng.df.cat<span class="op">$</span>OtherDebtors)
eng.df.cat<span class="op">$</span>OtherDebtors =<span class="kw">combineLevels</span>( eng.df.cat<span class="op">$</span>OtherDebtors, <span class="dt">levs =</span> <span class="kw">c</span>(<span class="st">&quot;guarantor &quot;</span>,<span class="st">&quot;co-applicant &quot;</span> ), <span class="dt">newLabel =</span> <span class="st">&quot;yes&quot;</span>)

eng.df.cat<span class="op">$</span>OtherInstallments =<span class="st"> </span><span class="kw">combineLevels</span>(eng.df.cat<span class="op">$</span>OtherInstallments, <span class="dt">levs =</span> <span class="kw">c</span>(<span class="st">&quot;bank &quot;</span>,<span class="st">&quot;stores &quot;</span>), <span class="dt">newLabel =</span> <span class="kw">c</span>(<span class="st">&quot;bank/stores&quot;</span>))

eng.df.cat<span class="op">$</span>Job =<span class="st"> </span><span class="kw">combineLevels</span>(eng.df.cat<span class="op">$</span>Job,<span class="dt">levs =</span> <span class="kw">c</span>(<span class="st">&quot;unemployed/ unskilled &quot;</span>, <span class="st">&quot;unskilled - resident &quot;</span>), <span class="dt">newLabel =</span> <span class="kw">c</span>(<span class="st">&quot;unemployed/unskilled&quot;</span>) )

eng.df.cat<span class="op">$</span>CreditHistory =<span class="st"> </span><span class="kw">combineLevels</span>(eng.df.cat<span class="op">$</span>CreditHistory, <span class="dt">levs =</span> <span class="kw">c</span>(<span class="st">&quot;all credits at this bank paid back duly &quot;</span> ,<span class="st">&quot;all credits paid back duly &quot;</span> ), <span class="dt">newLabel =</span> <span class="kw">c</span>(<span class="st">&quot;Paid&quot;</span>))

<span class="co">#sapply(eng.df.cat, function(x) margin.table(prop.table(table(x)),1) )</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eng.df.cat<span class="op">$</span>ForeignWorker =<span class="st"> </span><span class="ot">NULL</span> <span class="co">#drops the frgn column</span></code></pre></div>
</div>
<div id="machine-learning" class="section level1">
<h1>Machine Learning</h1>
<p>It is time to fit our data with various statistical models. I will first recombine our numerical and categorical features to split the full data into two equal sets: (1) Training set that will serve to fit various statistical models and (2)Validation set that wll serve to test the accuracy of each model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data =<span class="st"> </span><span class="kw">cbind</span>(eng.df.cat,df.num)
<span class="kw">set.seed</span>(<span class="dv">1</span>)

train =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(data), <span class="dt">size =</span> <span class="kw">nrow</span>(data)<span class="op">*</span>.<span class="dv">50</span> )
data.train =<span class="st"> </span>data[train,]
data.test =<span class="st"> </span>data[<span class="op">-</span>train,]

GoodCreditity.test =<span class="st"> </span>data.test<span class="op">$</span>GoodCredit</code></pre></div>
<div id="logistic-regression" class="section level2">
<h2>Logistic Regression</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Base Model</span>
logistic.fit =<span class="st"> </span><span class="kw">glm</span>(GoodCredit<span class="op">~</span>., <span class="dt">data =</span> data, <span class="dt">subset =</span> train, <span class="dt">family =</span> binomial)
sig.level =<span class="kw">data.frame</span>(<span class="kw">summary</span>(logistic.fit)<span class="op">$</span>coef)
sig.level</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Estimate"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Std..Error"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["z.value"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr...z.."],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"-4.0224919032","2":"1.431959e+00","3":"-2.8090823","4":"4.968295e-03","_rn_":"(Intercept)"},{"1":"-1.1774806099","2":"3.274609e-01","3":"-3.5957899","4":"3.234088e-04","_rn_":"StatusCheckingAccno checking account"},{"1":"-0.2421331795","2":"3.027951e-01","3":"-0.7996601","4":"4.239077e-01","_rn_":"StatusCheckingAccSome Balance"},{"1":"0.8279743081","2":"4.828560e-01","3":"1.7147437","4":"8.639223e-02","_rn_":"CreditHistorydelay in paying off in the past"},{"1":"1.5613482604","2":"3.971152e-01","3":"3.9317266","4":"8.433796e-05","_rn_":"CreditHistoryexisting credits paid back duly till now"},{"1":"1.8154400300","2":"4.851522e-01","3":"3.7420013","4":"1.825606e-04","_rn_":"CreditHistoryPaid"},{"1":"-2.4483505675","2":"6.077786e-01","3":"-4.0283594","4":"5.616743e-05","_rn_":"Purposecar (used)"},{"1":"-0.9486702453","2":"3.076256e-01","3":"-3.0838467","4":"2.043429e-03","_rn_":"PurposeHome Related"},{"1":"-0.7228378956","2":"3.686220e-01","3":"-1.9609191","4":"4.988847e-02","_rn_":"PurposeOther"},{"1":"-0.6143957980","2":"4.134954e-01","3":"-1.4858588","4":"1.373165e-01","_rn_":"SavingsAccount100 <= ... < 500 DM"},{"1":"-1.0992783014","2":"3.790153e-01","3":"-2.9003536","4":"3.727419e-03","_rn_":"SavingsAccountno savings"},{"1":"-0.7287839254","2":"4.483301e-01","3":"-1.6255522","4":"1.040449e-01","_rn_":"SavingsAccount>= 500"},{"1":"0.2397797176","2":"3.490028e-01","3":"0.6870423","4":"4.920560e-01","_rn_":"EmployedSince1 <= ... < 4 years"},{"1":"-0.5411413173","2":"4.459416e-01","3":"-1.2134802","4":"2.249463e-01","_rn_":"EmployedSince4 <= ... < 7 years"},{"1":"0.4318976671","2":"3.792139e-01","3":"1.1389288","4":"2.547329e-01","_rn_":"EmployedSince<1 or unemployed"},{"1":"-0.3532890504","2":"4.601406e-01","3":"-0.7677851","4":"4.426149e-01","_rn_":"SexPersonalStatusmale - married/widowed"},{"1":"-0.1185437306","2":"3.105588e-01","3":"-0.3817111","4":"7.026756e-01","_rn_":"SexPersonalStatusmale - single/divorced"},{"1":"-0.6973300006","2":"4.619844e-01","3":"-1.5094234","4":"1.311906e-01","_rn_":"OtherDebtorsyes"},{"1":"-0.2050619720","2":"3.212607e-01","3":"-0.6383039","4":"5.232759e-01","_rn_":"Propertycar or other, not in attribute 6"},{"1":"0.6415386931","2":"5.547211e-01","3":"1.1565067","4":"2.474740e-01","_rn_":"Propertyno property"},{"1":"-0.5818103359","2":"3.570635e-01","3":"-1.6294311","4":"1.032218e-01","_rn_":"Propertyreal estate"},{"1":"0.9459467177","2":"2.965678e-01","3":"3.1896475","4":"1.424464e-03","_rn_":"OtherInstallmentsbank/stores"},{"1":"0.5354319821","2":"6.205264e-01","3":"0.8628674","4":"3.882104e-01","_rn_":"Housingown"},{"1":"0.8317049320","2":"6.625823e-01","3":"1.2552477","4":"2.093889e-01","_rn_":"Housingrent"},{"1":"0.4048621889","2":"4.211094e-01","3":"0.9614181","4":"3.363420e-01","_rn_":"Jobskilled employee / official"},{"1":"0.2346147212","2":"5.003296e-01","3":"0.4689204","4":"6.391266e-01","_rn_":"Jobunemployed/unskilled"},{"1":"-0.1021898875","2":"2.937343e-01","3":"-0.3478990","4":"7.279160e-01","_rn_":"Telephoneyes"},{"1":"0.0383846817","2":"1.392267e-02","3":"2.7569916","4":"5.833586e-03","_rn_":"Duration"},{"1":"0.0001020386","2":"7.414435e-05","3":"1.3762157","4":"1.687549e-01","_rn_":"CreditAmount"},{"1":"0.2347495656","2":"1.281782e-01","3":"1.8314306","4":"6.703630e-02","_rn_":"InstallmentRate"},{"1":"0.1255694291","2":"1.222451e-01","3":"1.0271938","4":"3.043292e-01","_rn_":"PresentResidenceSince"},{"1":"-0.0161311219","2":"1.265545e-02","3":"-1.2746381","4":"2.024374e-01","_rn_":"Age"},{"1":"0.6187391680","2":"2.714515e-01","3":"2.2793725","4":"2.264493e-02","_rn_":"NumberOfExistingCredits"},{"1":"0.0937084735","2":"3.554298e-01","3":"0.2636483","4":"7.920509e-01","_rn_":"NumberOfPeopleLiable"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Model 3</span>
logistic.fit3 =<span class="st"> </span><span class="kw">glm</span>(GoodCredit<span class="op">~</span>. <span class="op">-</span>SexPersonalStatus <span class="op">-</span>Telephone  <span class="op">-</span>NumberOfPeopleLiable <span class="op">-</span>Job <span class="op">-</span>Housing <span class="op">-</span>PresentResidenceSince <span class="op">-</span>CreditAmount, <span class="dt">data =</span> data, <span class="dt">subset =</span> train, <span class="dt">family =</span> binomial)

 
logistic.probs  =<span class="st"> </span><span class="kw">predict</span>(logistic.fit3, data.test, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)
<span class="co">#30% threshold</span>
glm.predict1 =<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;credible&quot;</span>, <span class="dv">500</span>)
glm.predict1[logistic.probs <span class="op">&gt;</span><span class="st"> </span>.<span class="dv">30</span>] =<span class="st"> &quot;non.credible&quot;</span>
<span class="co">#50% threshold</span>
glm.predict2 =<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;credible&quot;</span>, <span class="dv">500</span>)
glm.predict2[logistic.probs <span class="op">&gt;</span><span class="st"> </span>.<span class="dv">50</span>] =<span class="st"> &quot;non.credible&quot;</span>


glm.TN.FP1 =<span class="st"> </span><span class="kw">table</span>(GoodCreditity.test, glm.predict1)[,<span class="dv">1</span>]<span class="op">/</span><span class="dv">500</span>
glm.TN.FP2 =<span class="st"> </span><span class="kw">table</span>(GoodCreditity.test, glm.predict2)[,<span class="dv">1</span>]<span class="op">/</span><span class="dv">500</span></code></pre></div>
</div>
<div id="linear-discriminant-analysis" class="section level2">
<h2>linear Discriminant Analysis</h2>
<p>LDA assumes a multivariate normal distribution, hence we only use predictors that are either ordinal or continuos.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
lda.fit =<span class="st"> </span><span class="kw">lda</span>(GoodCredit<span class="op">~</span>SavingsAccount<span class="op">+</span>EmployedSince<span class="op">+</span>Duration<span class="op">+</span>OtherInstallments<span class="op">+</span>InstallmentRate<span class="op">+</span>NumberOfExistingCredits<span class="op">+</span>Age<span class="op">+</span>CreditAmount ,<span class="dt">data=</span>data, <span class="dt">subset=</span>train)

lda.pred =<span class="st"> </span><span class="kw">predict</span>(lda.fit, data.test)
lda.TP.FP =<span class="st"> </span><span class="kw">table</span>(GoodCreditity.test,lda.pred<span class="op">$</span>class)[,<span class="dv">1</span>]<span class="op">/</span><span class="dv">500</span>

lda.fit2 =<span class="st"> </span><span class="kw">lda</span>(GoodCredit<span class="op">~</span>. ,<span class="dt">data=</span>data, <span class="dt">subset=</span>train)
lda.pred2 =<span class="st"> </span><span class="kw">predict</span>(lda.fit2, data.test)
classification =<span class="st"> </span>lda.pred2<span class="op">$</span>class
lda.TP.FP2 =<span class="st"> </span><span class="kw">table</span>(GoodCreditity.test, classification)[,<span class="dv">1</span>]<span class="op">/</span><span class="dv">500</span>


<span class="co">#qda</span>
qda.fit =<span class="st"> </span><span class="kw">qda</span>(GoodCredit<span class="op">~</span>., <span class="dt">data=</span>data, <span class="dt">subset=</span>train)
qda.pred =<span class="st"> </span><span class="kw">predict</span>(qda.fit, data.test)
qda.TP.FP =<span class="st"> </span><span class="kw">table</span>(GoodCreditity.test, qda.pred<span class="op">$</span>class)[,<span class="dv">1</span>]<span class="op">/</span><span class="dv">500</span></code></pre></div>
</div>
<div id="tree-based-methods" class="section level2">
<h2>Tree Based Methods</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tree)
tree.cred =<span class="st"> </span><span class="kw">tree</span>(GoodCredit<span class="op">~</span>., data, <span class="dt">subset =</span> train)
tree.pred =<span class="st"> </span><span class="kw">predict</span>(tree.cred, data.test, <span class="dt">type=</span><span class="st">&quot;class&quot;</span>)
tree.TP.FP =<span class="st"> </span><span class="kw">table</span>(GoodCreditity.test, tree.pred)[,<span class="dv">1</span>]<span class="op">/</span><span class="dv">500</span>

<span class="co">#summary(tree.cred)</span></code></pre></div>
<div id="prunning-the-tree" class="section level3">
<h3>Prunning the tree</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">3</span>)
cv.data =<span class="st"> </span><span class="kw">cv.tree</span>(tree.cred, <span class="dt">FUN =</span> prune.misclass)
best.size =<span class="st"> </span>cv.data<span class="op">$</span>size[<span class="kw">which.min</span>(cv.data<span class="op">$</span>dev)]

prune.data =<span class="st"> </span><span class="kw">prune.misclass</span>(tree.cred, <span class="dt">best =</span> best.size)
tree.pred2 =<span class="st"> </span><span class="kw">predict</span>(prune.data, data.test, <span class="dt">type=</span><span class="st">&quot;class&quot;</span>)
tree.TP.FP2 =<span class="st"> </span><span class="kw">table</span>(GoodCreditity.test, tree.pred2)[,<span class="dv">1</span>]<span class="op">/</span><span class="dv">500</span></code></pre></div>
</div>
<div id="random-forest" class="section level3">
<h3>Random Forest</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rf.data =<span class="st"> </span><span class="kw">randomForest</span>(GoodCredit<span class="op">~</span>., <span class="dt">data=</span> data , <span class="dt">subset=</span> train, <span class="dt">mtry =</span> <span class="dv">6</span>, <span class="dt">importance =</span>T)
rf.predict =<span class="st"> </span><span class="kw">predict</span>(rf.data, data.test)
Forest.TP.FP =<span class="st"> </span><span class="kw">table</span>(GoodCreditity.test, rf.predict)[,<span class="dv">1</span>]<span class="op">/</span><span class="dv">500</span></code></pre></div>
</div>
</div>
<div id="smc-and-svm" class="section level2">
<h2>SMC and SVM</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#svm.fit = svm(GoodCredit~., data = data.train, kernel = &quot;linear&quot;, cost = 10, scale =FALSE)</span>
tune.out =<span class="st"> </span><span class="kw">tune</span>(svm, GoodCredit<span class="op">~</span>., <span class="dt">data =</span> data.train, <span class="dt">kernel =</span> <span class="st">&quot;linear&quot;</span>, <span class="dt">ranges =</span> <span class="kw">list</span>(<span class="dt">cost=</span><span class="kw">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">100</span>)))
bestmod =<span class="st"> </span>tune.out<span class="op">$</span>best.model
<span class="co">#summary(bestmod)</span>

svc.predict =<span class="st"> </span><span class="kw">predict</span>(bestmod, data.test)
svc.TP.FP =<span class="st"> </span><span class="kw">table</span>( GoodCreditity.test, svc.predict)[,<span class="dv">1</span>]<span class="op">/</span><span class="dv">500</span>




<span class="co">#radial kernel</span>
svm.fit =<span class="st"> </span><span class="kw">svm</span>(GoodCredit<span class="op">~</span>., <span class="dt">data =</span> data.train, <span class="dt">kernel =</span> <span class="st">&quot;radial&quot;</span>, <span class="dt">gamma =</span> <span class="dv">1</span>, <span class="dt">cost =</span> <span class="dv">1</span>)
tune.out=<span class="kw">tune</span>(svm, GoodCredit<span class="op">~</span>., <span class="dt">data=</span>data.train, <span class="dt">kernel=</span><span class="st">&quot;radial&quot;</span>,<span class="dt">cranges=</span><span class="kw">list</span>(<span class="dt">cost=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>), <span class="dt">gamma=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) ))
bestmod =<span class="st"> </span>tune.out<span class="op">$</span>best.model

svm.predict =<span class="st"> </span><span class="kw">predict</span>(bestmod,data.test) 
svm.TP.FP =<span class="st"> </span><span class="kw">table</span>(GoodCreditity.test, svm.predict)[,<span class="dv">1</span>]<span class="op">/</span><span class="dv">500</span></code></pre></div>
</div>
</div>
<div id="summary-cost-profit-consideration" class="section level1">
<h1>Summary/ Cost-Profit Consideration</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cross.profit =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="dv">9</span>, <span class="dt">nrow =</span> <span class="dv">3</span>))
<span class="kw">rownames</span>(cross.profit) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Credible&quot;</span>, <span class="st">&quot;Non-Credible&quot;</span>, <span class="st">&quot;Per Applicant Profit&quot;</span>)


cross.profit<span class="op">$</span>X1 =<span class="st"> </span><span class="kw">cost_profit_cal</span>(glm.TN.FP1)
cross.profit<span class="op">$</span>X2 =<span class="st"> </span><span class="kw">cost_profit_cal</span>(glm.TN.FP2)
cross.profit<span class="op">$</span>X3 =<span class="st"> </span><span class="kw">cost_profit_cal</span>(lda.TP.FP2)
cross.profit<span class="op">$</span>X4 =<span class="st"> </span><span class="kw">cost_profit_cal</span>(qda.TP.FP)
cross.profit<span class="op">$</span>X5 =<span class="st"> </span><span class="kw">cost_profit_cal</span>(tree.TP.FP)
cross.profit<span class="op">$</span>X6 =<span class="st"> </span><span class="kw">cost_profit_cal</span>(tree.TP.FP2)
cross.profit<span class="op">$</span>X7 =<span class="st"> </span><span class="kw">cost_profit_cal</span>(Forest.TP.FP)
cross.profit<span class="op">$</span>X8 =<span class="st"> </span><span class="kw">cost_profit_cal</span>(svc.TP.FP)
cross.profit<span class="op">$</span>X9 =<span class="st"> </span><span class="kw">cost_profit_cal</span>(svm.TP.FP)



cross.profit <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_header_above</span>(<span class="kw">c</span>(<span class="st">&quot;Test &quot;</span>, <span class="st">&quot;30% threshold&quot;</span> , <span class="st">&quot;50% threshold&quot;</span>, <span class="st">&quot;Linear&quot;</span>, <span class="st">&quot;quadratic&quot;</span>,<span class="st">&quot;Unpruned Tree&quot;</span>, <span class="st">&quot;Pruned Tree&quot;</span>,<span class="st">&quot;Random Forest&quot;</span>, <span class="st">&quot;SVC&quot;</span>, <span class="st">&quot;SVM&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_header_above</span>(<span class="kw">c</span>( <span class="st">&quot;&quot;</span>, <span class="st">&quot;Logistic&quot;</span> =<span class="st"> </span><span class="dv">2</span>, <span class="st">&quot;Discriminant Analysis&quot;</span> =<span class="st"> </span><span class="dv">2</span>, <span class="st">&quot;Trees&quot;</span> =<span class="st"> </span><span class="dv">2</span>, <span class="st">&quot;&quot;</span> , <span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span> ))</code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden" colspan="1">
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
Logistic
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
Discriminant Analysis
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
Trees
</div>
</th>
<th style="border-bottom:hidden" colspan="1">
</th>
<th style="border-bottom:hidden" colspan="1">
</th>
<th style="border-bottom:hidden" colspan="1">
</th>
</tr>
<tr>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
Test
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
30% threshold
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
50% threshold
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
Linear
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
quadratic
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
Unpruned Tree
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
Pruned Tree
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
Random Forest
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
SVC
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
SVM
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
X1
</th>
<th style="text-align:right;">
X2
</th>
<th style="text-align:right;">
X3
</th>
<th style="text-align:right;">
X4
</th>
<th style="text-align:right;">
X5
</th>
<th style="text-align:right;">
X6
</th>
<th style="text-align:right;">
X7
</th>
<th style="text-align:right;">
X8
</th>
<th style="text-align:right;">
X9
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Credible
</td>
<td style="text-align:right;">
0.500
</td>
<td style="text-align:right;">
0.600
</td>
<td style="text-align:right;">
0.6040
</td>
<td style="text-align:right;">
0.5780
</td>
<td style="text-align:right;">
0.5760
</td>
<td style="text-align:right;">
0.6180
</td>
<td style="text-align:right;">
0.6440
</td>
<td style="text-align:right;">
0.6160
</td>
<td style="text-align:right;">
0.6660
</td>
</tr>
<tr>
<td style="text-align:left;">
Non-Credible
</td>
<td style="text-align:right;">
0.102
</td>
<td style="text-align:right;">
0.176
</td>
<td style="text-align:right;">
0.1780
</td>
<td style="text-align:right;">
0.1520
</td>
<td style="text-align:right;">
0.1880
</td>
<td style="text-align:right;">
0.2020
</td>
<td style="text-align:right;">
0.2120
</td>
<td style="text-align:right;">
0.2120
</td>
<td style="text-align:right;">
0.2900
</td>
</tr>
<tr>
<td style="text-align:left;">
Per Applicant Profit
</td>
<td style="text-align:right;">
0.073
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:right;">
0.0334
</td>
<td style="text-align:right;">
0.0503
</td>
<td style="text-align:right;">
0.0136
</td>
<td style="text-align:right;">
0.0143
</td>
<td style="text-align:right;">
0.0134
</td>
<td style="text-align:right;">
0.0036
</td>
<td style="text-align:right;">
-0.0569
</td>
</tr>
</tbody>
</table>
<p>In conclusion, Logistic Regression at a 30% threshold turned out to have the biggest profit per applicant.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
